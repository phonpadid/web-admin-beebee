import{C as _,z as v,m as d}from"./index-BpXBQnxn.js";import{i as m,a as l,A as y,b as h}from"./axios.config-9RTEzkkw.js";var w=Object.defineProperty,A=Object.getOwnPropertyDescriptor,S=(a,s,e,i)=>{for(var t=i>1?void 0:i?A(s,e):s,r=a.length-1,o;r>=0;r--)(o=a[r])&&(t=(i?o(s,e,t):o(t))||t);return i&&t&&w(s,e,t),t},O=(a,s)=>(e,i)=>s(e,i,a);let c=class{constructor(a){this._api=a}async create(a){var i;const s=new FormData;return a.first_name&&s.append("first_name",(i=a.first_name)==null?void 0:i.toString()),s.append("last_name",a.last_name),s.append("email",a.email),a.type&&s.append("type",a.type),s.append("phone_number",a.phone_number),s.append("is_active",String(!0)),a.password&&s.append("password",a.password.toString()),a.password_confirmation&&s.append("confirm_password",a.password_confirmation.toString()),a.groups&&Array.isArray(a.groups)&&a.groups.forEach(t=>{s.append("groups",t.toString())}),a.user_permissions&&Array.isArray(a.user_permissions)&&a.user_permissions.forEach(t=>{s.append("user_permissions",t.toString())}),a.avatar&&s.append("avatar",a.avatar),{data:(await this._api.axios({method:"post",url:"/accounts/customers/",data:s,headers:{"Content-Type":"multipart/form-data"}})).data,message:"ບັນທຶກສຳເລັດ",status:"success"}}async update(a,s){var t,r;const e=new FormData;return a.id&&e.append("id",(t=a.id)==null?void 0:t.toString()),a.first_name&&e.append("first_name",(r=a.first_name)==null?void 0:r.toString()),a.type&&e.append("type",a.type),e.append("last_name",a.last_name),e.append("email",a.email),e.append("phone_number",a.phone_number),e.append("is_superuser",String(a.is_superuser)),e.append("is_active",String(a.is_active)),a.groups&&Array.isArray(a.groups)&&a.groups.forEach(o=>{e.append("groups",o.toString())}),a.user_permissions&&Array.isArray(a.user_permissions)&&a.user_permissions.forEach(o=>{e.append("user_permissions",o.toString())}),a.avatar&&e.append("avatar",a.avatar),{data:(await this._api.axios({method:"put",url:`/accounts/customers/${s}/`,data:e,headers:{"Content-Type":"multipart/form-data"}})).data,message:"ອັບເດດສຳເລັດ",status:"success"}}async getAll(a){const s=await this._api.axios({url:"/accounts/customers/",params:{page:a.page,page_size:a.limit}}),{results:e,count:i}=s.data;return{data:{props:e.map(r=>({customer_id:r==null?void 0:r.id,id:r==null?void 0:r.user.id,first_name:r.user.first_name,last_name:r.user.last_name,email:r.user.email,type:r.type,avatar:r.user.avatar,full_avatar_url:r.user.full_avatar_url,created_at:r.created_at})),total:i},status:"success"}}async getOne(a){const s=await this._api.axios({url:"/accounts/customers/"+a});return{data:{customer_id:s.data.id,id:s.data.id,type:s.data.type,first_name:s.data.user.first_name,last_name:s.data.user.last_name,phone_number:s.data.user.phone_number,email:s.data.user.email,full_avatar_url:s.data.user.full_avatar_url,created_at:_(s.data.user.created_at).format("MM-DD-YYYY HH:mm:ss"),updated_at:_(s.data.user.updated_at).format("MM-DD-YYYY HH:mm:ss"),is_active:s.data.user.is_active,groups:s.data.user.groups,user_permissions:s.data.user.user_permissions},status:"success"}}async remove(a){const s=await this._api.axios({method:"delete",url:`/accounts/customers/${a}/`});return{data:s.data,status:s.data.status}}};c=S([m(),O(0,l(y))],c);var b=Object.defineProperty,D=Object.getOwnPropertyDescriptor,C=(a,s,e,i)=>{for(var t=i>1?void 0:i?D(s,e):s,r=a.length-1,o;r>=0;r--)(o=a[r])&&(t=(i?o(s,e,t):o(t))||t);return i&&t&&b(s,e,t),t},P=(a,s)=>(e,i)=>s(e,i,a);let u=class{constructor(a){this._api=a}async create(a){return await this._api.create(a)}async update(a,s){return await this._api.update(a,s)}async getAll(a){return await this._api.getAll(a)}async getOne(a){return await this._api.getOne(a)}async remove(a){return await this._api.remove(a)}};u=C([m(),P(0,l(c))],u);const j=v("customer-store",()=>{const a=h.resolve(u),s=d({data:{props:[],total:0},isLoading:!1,btnLoading:!1,error:""}),e=d({limit:10,filter:{first_name:""}});async function i(){s.isLoading=!0;const n=await a.getAll({page:e.page,limit:e.limit,filter:e.filter});n&&n.data&&n.status==="success"&&(s.data.props=n.data.props,s.data.total=n.data.total,s.isLoading=!1)}const t=d({data:null,isLoading:!1,errorMessage:""});async function r(n){t.isLoading=!0;const p=await a.getOne(n);p&&p.data&&p.status==="success"&&(t.data=p.data,t.isLoading=!1)}async function o(n){t.isLoading=!0;const p=await a.remove(n);p&&p.data&&p.status==="success"&&(t.data=p.data,t.isLoading=!1)}async function f(n){return await a.create(n)}async function g(n,p){return await a.update(n,p)}return{getAllCustomer:i,create:f,update:g,getOneCustomer:r,stateGetOne:t,stateCustomer:s,setStateFilter:e,remove:o}});export{j as c};
