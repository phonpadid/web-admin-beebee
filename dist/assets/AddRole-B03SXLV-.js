import{u as M}from"./role.schema-Cs1BFjKF.js";import{r as T}from"./role.store-CX8tLYic.js";import{d as G,r as u,m as H,v as J,u as Q,k as W,o as t,f as d,g as h,c as n,h as p,j as f,t as c,n as b,i as o,e as l,a as X,p as Y,q as Z,F as ee,x as se,s as ae}from"./index-BpXBQnxn.js";import{p as oe}from"./permissions.store-1L6rt9_s.js";import{L as te}from"./LineChartOutlined-BheXCfHu.js";import"./axios.config-9RTEzkkw.js";const ne={class:"form-role"},le={class:"pb-4 flex justify-between"},re={key:0,style:{color:"red"}},me={key:1,style:{color:"red"}},ce={key:0},ie={class:"md:flex md:flex-row flex-col gap-4"},ye=G({__name:"AddRole",setup(ue){const{schema:S,schemaKey:E}=M(),F=u(!1),{create:K,getAll:L}=T(),{getAllPer:P,statePermission:R}=oe(),k=u(["2"]),v=u(!1),x=u(),{push:g}=X(),w={id:"",name:"",permissions:[]},r=u({...w}),m=H({}),j=async()=>{x.value.validate().then(async()=>{try{F.value=!0,await K(r.value),ae.success({message:y("messages.success"),description:y("messages.description")}),g({name:"roles.index"}),await L(),A()}catch(s){if(s.response&&s.response.data){const e=s.response.data||{};Object.keys(e).forEach(i=>{m[i]=Array(e[i])?e[i][0]:""})}}})},A=()=>{r.value={...w}},B=async()=>{v.value=!0;try{await P()}catch(s){console.error("Error fetching permissions:",s)}finally{v.value=!1}},N=s=>{m[s]=""};J(async()=>{await B()});const{t:y}=Q(),V=W(()=>({name:y("placeholder.role.name")})),U=()=>{g({name:"roles.index"})};return(s,e)=>{const i=l("a-input"),C=l("a-form-item"),D=l("a-checkbox"),I=l("a-checkbox-group"),O=l("a-collapse-panel"),q=l("a-collapse"),$=l("a-button"),z=l("a-form");return t(),d("div",ne,[h("div",le,[h("p",{onClick:U,class:"text-base font-bold text-blue-500 hover:text-blue-400"},[n(p(te)),f(" "+c(s.$t("messages.role.add_role")),1)])]),(t(),b(z,{layout:"vertical",ref_key:"form",ref:x,rules:p(S),key:p(E),model:r.value},{default:o(()=>[n(C,{class:"form-item-centered",label:s.$t("messages.role.name"),name:"name"},{default:o(()=>[n(i,{value:r.value.name,"onUpdate:value":e[0]||(e[0]=a=>r.value.name=a),placeholder:V.value.name,onInput:e[1]||(e[1]=a=>N("name")),class:Y(["h-[3rem]",{"ring-1 ring-red-500 mb-1":m.name}])},null,8,["value","placeholder","class"]),m.name&&m.name.length>=50?(t(),d("span",re,c(s.$t("messages.more_then")),1)):m.name&&m.name.length<40?(t(),d("span",me,c(s.$t("messages.exist_name")),1)):Z("",!0)]),_:1},8,["label"]),n(q,{activeKey:k.value,"onUpdate:activeKey":e[3]||(e[3]=a=>k.value=a),class:"mt-8"},{default:o(()=>[n(O,{key:"2",header:s.$t("messages.role.form.get_permissions"),name:"permissions",class:"w-full"},{default:o(()=>[v.value?(t(),d("div",ce,"Loading permissions...")):(t(),b(I,{key:1,value:r.value.permissions,"onUpdate:value":e[2]||(e[2]=a=>r.value.permissions=a),class:"flex flex-wrap gap-4"},{default:o(()=>{var a;return[(t(!0),d(ee,null,se(((a=p(R).data)==null?void 0:a.props)||[],_=>(t(),b(D,{key:_.id,value:_.id,label:_.name},{default:o(()=>[f(c(_.name),1)]),_:2},1032,["value","label"]))),128))]}),_:1},8,["value"]))]),_:1},8,["header"])]),_:1},8,["activeKey"]),h("div",ie,[n(C,{class:"flex items-center mt-4 justify-center"},{default:o(()=>[n($,{type:"primary",onClick:j},{default:o(()=>[f(c(s.$t("messages.role.btn.save")),1)]),_:1}),e[5]||(e[5]=f(" Â  ")),n($,{onClick:e[4]||(e[4]=a=>p(g)({name:"roles.index"})),danger:""},{default:o(()=>[f(c(s.$t("messages.role.btn.cancel")),1)]),_:1})]),_:1})])]),_:1},8,["rules","model"]))])}}});export{ye as default};
