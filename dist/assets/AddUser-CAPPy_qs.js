import{_ as te}from"./nodata-b6ZJ5XC7.js";import{r as oe}from"./role.store-DBlqig8t.js";import{u as re}from"./index-BOJxkmlB.js";import{d as ne,r as m,m as ue,u as ie,k as me,v as de,f as y,g as n,c as t,i as U,j as v,t as u,n as f,h as o,F as L,e as i,a as pe,o as r,q as F,x as V,s as D,_ as ce}from"./index-DmLjb2yN.js";import{u as ve}from"./user.schema-DT440Bsg.js";import{p as fe}from"./permissions.store-K_Dw0mD3.js";import{L as _e}from"./LineChartOutlined-suE0mfBf.js";import"./axios.config-9RTEzkkw.js";const be={class:"pb-4 flex justify-between"},we={class:"text-base font-bold text-blue-500"},ye={class:"flex flex-col items-center sm:items-start gap-6"},ge={key:1,src:te,width:"200rem",height:"200rem",class:"my-4",style:{"object-fit":"contain"},alt:"",srcset:""},he={class:"md:flex md:flex-row flex-col gap-4"},ke={style:{color:"red"}},xe={class:"md:flex md:flex-row flex-col gap-4"},Ue={style:{color:"red"}},$e={style:{color:"red"}},Le={class:"md:flex md:flex-row flex-col gap-4"},Se={style:{color:"red"}},je={key:0},Be={key:0},Ne={class:"md:flex md:flex-row flex-col gap-4"},Ce=ne({__name:"AddUser",setup(Ke){const{schema:T,schemaKey:q}=ve(),{push:S}=pe(),{state:G,getAll:j}=oe(),{statePermission:H,getAllPer:J}=fe(),c=m(null),g=m(""),{create:Q}=re(),_=ue({}),B={id:"",first_name:"",last_name:"",type:"",phone_number:"",groups:[],user_permissions:[],avatar:void 0,email:"",password:"",password_confirmation:""},{t:d}=ie(),b=me(()=>({firstName:d("placeholder.user.fname"),lastName:d("placeholder.user.lname"),phoneNumber:d("placeholder.user.phone_number"),email:d("placeholder.user.email"),password:d("placeholder.user.password"),confirmPassword:d("placeholder.user.confirm_password")})),N=m(),C=m(!1),l=m({...B}),W=()=>{l.value={...B}},X=async()=>{N.value.validate().then(async()=>{C.value=!0;try{l.value.password===l.value.password_confirmation?(await new Promise(s=>setTimeout(s,1e3)),await Q(l.value),D.success({message:d("messages.success"),description:d("messages.description")}),W(),C.value=!1,S({name:"user"}),await j()):D.warn({message:d("messages.error"),description:d("validation.change_password.password_no_match")})}catch(s){if(s.response&&s.response.data){const e=s.response.data||{};Object.keys(e).forEach(w=>{_[w]=Array(e[w])?e[w][0]:""})}}})},K=m([]),R=m([]),$=m(!0),Y=m(!0);function Z(s){return s.size>5242880?(g.value="ຂະໜາດຮູບຕ້ອງບໍ່ເກີນ 5MB",!1):(g.value="",c.value&&URL.revokeObjectURL(c.value),c.value=URL.createObjectURL(s),l.value.avatar=s,!1)}const ee=()=>{c.value&&(URL.revokeObjectURL(c.value),c.value=null),l.value.avatar=void 0},h=s=>{_[s]=""};de(async()=>{await j(),K.value=G.data.props.map(s=>({id:s.id,name:s.name})),$.value=!1,await J(),R.value=H.data.props.map(s=>({id:s.id,name:s.name})),Y.value=!1});const P=m(["2"]),I=m(["2"]);return(s,e)=>{const w=i("a-image"),ae=i("a-alert"),p=i("a-form-item"),k=i("a-button"),se=i("a-upload"),x=i("a-input"),M=i("a-input-password"),z=i("a-checkbox"),O=i("a-checkbox-group"),A=i("a-collapse-panel"),E=i("a-collapse"),le=i("a-form");return r(),y(L,null,[n("div",be,[n("p",we,[t(U(_e)),v(" "+u(s.$t("users.form_update")),1)])]),(r(),f(le,{layout:"vertical",ref_key:"form",ref:N,rules:U(T),key:U(q),model:l.value,class:"flex-col flex"},{default:o(()=>[t(p,{label:" ",class:"-mt-12",name:"avatar"},{default:o(()=>[n("div",ye,[c.value?(r(),f(w,{key:0,src:c.value,width:"10rem",height:"10rem",style:{"object-fit":"contain"}},{previewMask:o(()=>[n("span",null,u(s.$t("preview")),1)]),_:1},8,["src"])):(r(),y("img",ge)),g.value?(r(),f(ae,{key:2,message:g.value,type:"error",banner:"",closable:"",onClose:e[0]||(e[0]=a=>g.value="")},null,8,["message"])):F("",!0)])]),_:1}),t(p,{class:"-mt-12",label:" "},{default:o(()=>[t(se,{showUploadList:!1,accept:".png, .jpeg, .jpg",multiple:"","before-upload":Z},{default:o(()=>[t(k,null,{default:o(()=>[v(u(s.$t("customers.table_field.choose_profile")),1)]),_:1})]),_:1}),l.value.avatar?(r(),f(k,{key:0,onClick:ee,class:"ml-4 text-red-600"},{default:o(()=>[v(u(s.$t("customers.table_field.btn.remove")),1)]),_:1})):F("",!0)]),_:1}),n("div",he,[t(p,{label:s.$t("users.table_field.fname"),name:"first_name",class:"w-full"},{default:o(()=>[t(x,{placeholder:b.value.firstName,class:"h-12",value:l.value.first_name,"onUpdate:value":e[1]||(e[1]=a=>l.value.first_name=a),onInput:e[2]||(e[2]=a=>h("first_name"))},null,8,["placeholder","value"]),n("span",ke,u(_.first_name),1)]),_:1},8,["label"]),t(p,{label:s.$t("users.table_field.lname"),name:"last_name",class:"w-full"},{default:o(()=>[t(x,{placeholder:b.value.lastName,class:"h-12",value:l.value.last_name,"onUpdate:value":e[3]||(e[3]=a=>l.value.last_name=a)},null,8,["placeholder","value"])]),_:1},8,["label"])]),n("div",xe,[t(p,{label:s.$t("users.table_field.phone_number"),name:"phone_number",class:"w-full"},{default:o(()=>[t(x,{placeholder:b.value.phoneNumber,class:"h-12",value:l.value.phone_number,"onUpdate:value":e[4]||(e[4]=a=>l.value.phone_number=a),onInput:e[5]||(e[5]=a=>h("phone_number"))},null,8,["placeholder","value"]),n("span",Ue,u(_.phone_number),1)]),_:1},8,["label"]),t(p,{label:s.$t("users.table_field.email"),name:"email",class:"w-full"},{default:o(()=>[t(x,{placeholder:b.value.email,class:"h-12",value:l.value.email,"onUpdate:value":e[6]||(e[6]=a=>l.value.email=a),onInput:e[7]||(e[7]=a=>h("email"))},null,8,["placeholder","value"]),n("span",$e,u(_.email),1)]),_:1},8,["label"])]),n("div",Le,[t(p,{label:s.$t("users.table_field.password"),name:"password",class:"w-full"},{default:o(()=>[t(M,{type:"password",placeholder:b.value.password,class:"h-12",value:l.value.password,"onUpdate:value":e[8]||(e[8]=a=>l.value.password=a),onInput:e[9]||(e[9]=a=>h("password"))},null,8,["placeholder","value"]),n("span",Se,u(_.password),1)]),_:1},8,["label"]),t(p,{label:s.$t("users.table_field.confirm_password"),name:"password_confirmation",class:"w-full"},{default:o(()=>[t(M,{type:"password",placeholder:b.value.confirmPassword,class:"h-12",value:l.value.password_confirmation,"onUpdate:value":e[10]||(e[10]=a=>l.value.password_confirmation=a)},null,8,["placeholder","value"])]),_:1},8,["label"])]),t(E,{activeKey:P.value,"onUpdate:activeKey":e[12]||(e[12]=a=>P.value=a),class:"mt-2"},{default:o(()=>[t(A,{key:"2",header:s.$t("users.table_field.get_roles"),name:"groups",class:"w-full"},{default:o(()=>[$.value?(r(),y("div",je,"Loading roles...")):(r(),f(O,{key:1,value:l.value.groups,"onUpdate:value":e[11]||(e[11]=a=>l.value.groups=a),class:"flex flex-wrap gap-4"},{default:o(()=>[(r(!0),y(L,null,V(K.value,a=>(r(),f(z,{key:a.id,value:a.id,label:a.name},{default:o(()=>[v(u(a.name),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["value"]))]),_:1},8,["header"])]),_:1},8,["activeKey"]),t(E,{activeKey:I.value,"onUpdate:activeKey":e[14]||(e[14]=a=>I.value=a),class:"mt-8"},{default:o(()=>[t(A,{key:"2",header:s.$t("users.table_field.get_permissions"),name:"user_permission",class:"w-full"},{default:o(()=>[$.value?(r(),y("div",Be,"Loading permission...")):(r(),f(O,{key:1,value:l.value.user_permissions,"onUpdate:value":e[13]||(e[13]=a=>l.value.user_permissions=a),class:"flex flex-wrap gap-4"},{default:o(()=>[(r(!0),y(L,null,V(R.value,a=>(r(),f(z,{key:a.id,value:a.id,label:a.name},{default:o(()=>[v(u(a.name),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["value"]))]),_:1},8,["header"])]),_:1},8,["activeKey"]),n("div",Ne,[t(p,{class:"flex items-center mt-4 justify-center"},{default:o(()=>[t(k,{type:"primary",onClick:X},{default:o(()=>[v(u(s.$t("users.save")),1)]),_:1}),e[16]||(e[16]=v("   ")),t(k,{danger:"",onClick:e[15]||(e[15]=a=>U(S)({name:"user.list"}))},{default:o(()=>[v(u(s.$t("users.cancel")),1)]),_:1})]),_:1})])]),_:1},8,["rules","model"]))],64)}}}),Fe=ce(Ce,[["__scopeId","data-v-d410af43"]]);export{Fe as default};
